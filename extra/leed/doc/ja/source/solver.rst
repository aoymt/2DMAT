入出力
********************************

``2DMAT-LEED`` モジュールは ``SATLEED`` を用いて原子位置などから Rocking curve を計算し、実験で得られた Rocking curve からの誤差を :math:`f(x)` として返す ``Solver`` です。

この章では、入力パラメータおよび入力データと出力データについて説明します。入力パラメータは Info　クラスの ``solver`` の項目が該当します。TOMLファイルを入力として与える場合は ``[solver]`` セクションに記述します。dict形式でパラメータを作成する場合は ``solver`` キー以下に入れ子の dict形式でデータを用意します。以下では、TOML形式でパラメータ項目を説明します。

入力データは、ターゲットとなる参照データとバルク構造データです。出力データは最適解の結果を格納したファイルです。以下の節で内容を示します。


入力パラメータ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

``solver`` セクション中のサブセクション ``config``,  ``reference`` を利用します。

[``config``] セクション
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- ``path_to_solver``

  形式: string型

  説明: ソルバー ``satl2.exe`` へのパス


[``reference``] セクション
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- ``path_to_base_dir``

  形式: string型

  説明: - ``exp.d``, ``rfac.d``, ``tleed4.i``, ``tleed5.i`` , ``tleed.o`` , ``short.t`` が格納されたディレクトリへのパス。

  
ソルバー用補助ファイル
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ターゲット参照ファイル
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ターゲットにするデータが格納されたファイル。 [``reference``] セクションの ``path_to_base_dir`` 中にある ``tleed4.i`` を編集します。最適化したい数値を ``optxxx`` (xxxは000, 001, 002, ...の形式で指定する三桁の整数)として指定します。なお、xxxの数字と ``py2dmat`` の最適化する値を入れる変数のリストの順番・個数は一致させる必要があります。なお、IFLAG, LSFLAGを0にしない場合はsatleed側での最適化も行われます。

以下、ファイル例を記載します。

.. code-block::

    1  0  0                          IPR ISTART LRFLAG
    1 10  0.02  0.2                  NSYM  NSYMS ASTEP VSTEP
    5  1  2  2                       NT0  NSET LSMAX LLCUT
    5                                NINSET
    1.0000 0.0000                  1      PQEX
    1.0000 2.0000                  2      PQEX
    1.0000 1.0000                  3      PQEX
    2.0000 2.0000                  4      PQEX
    2.0000 0.0000                  5      PQEX
    3                                NDIM
    opt000 0.0000 0.0000  0           DISP(1,j)  j=1,3
    0.0000 opt001 0.0000  0           DISP(2,j)  j=1,3
    0.0000 0.0000 0.0000  1           DISP(3,j)  j=1,3
    0.0000 0.0000 0.0000  0           DISP(4,j)  j=1,3
    0.0000  0                         DVOPT  LSFLAG
    3  0  0                          MFLAG NGRID NIV
    ...
   
出力ファイル
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

``leed`` では、 ``output_dir`` に指定する出力ディレクトリ内のランクの番号が記載されたフォルダ下に、計算時に出力されるファイル一式が出力されます。
